<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DAGA - Quiz SQL Multijoueur</title>
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a2a6c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="DAGA Quiz">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <!-- Styles -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    
    <style>
        /* Styles additionnels pour l'app */
        .install-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 30px;
            font-size: 1.1rem;
            cursor: pointer;
            margin: 20px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .install-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }
        
        .platform-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 30px 0;
        }
        
        .platform-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 15px 25px;
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .platform-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }
        
        .hero {
            text-align: center;
            padding: 50px 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            margin-bottom: 40px;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .feature {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="hero">
                <div class="logo" style="font-size: 4rem; color: #00d4ff; margin-bottom: 20px;">
                    <i class="fas fa-database"></i>
                </div>
                <h1 style="font-size: 3rem;">DAGA - Quiz SQL Multijoueur</h1>
                <p style="font-size: 1.3rem; max-width: 800px; margin: 0 auto 30px;">
                    T√©l√©chargez l'application pour jouer hors ligne, recevoir des notifications et profiter d'une exp√©rience optimis√©e !
                </p>
                
                <!-- Bouton d'installation PWA -->
                <button class="install-btn" id="installButton" style="display: none;">
                    <i class="fas fa-download"></i> Installer l'application
                </button>
                
                <div style="margin: 20px 0;">
                    <a href="game.html" class="install-btn">
                        <i class="fas fa-play"></i> Jouer maintenant en ligne
                    </a>
                </div>
            </div>
        </header>
        
        <!-- Section t√©l√©chargement -->
        <div class="panel">
            <h2><i class="fas fa-download"></i> T√©l√©charger DAGA</h2>
            <p>Disponible sur toutes les plateformes :</p>
            
            <div class="platform-buttons">
                <a href="#windows" class="platform-btn">
                    <i class="fab fa-windows"></i>
                    <div>
                        <div>Windows</div>
                        <small>.exe - 50 MB</small>
                    </div>
                </a>
                
                <a href="#mac" class="platform-btn">
                    <i class="fab fa-apple"></i>
                    <div>
                        <div>macOS</div>
                        <small>.dmg - 55 MB</small>
                    </div>
                </a>
                
                <a href="#android" class="platform-btn">
                    <i class="fab fa-android"></i>
                    <div>
                        <div>Android</div>
                        <small>.apk - 35 MB</small>
                    </div>
                </a>
                
                <a href="#linux" class="platform-btn">
                    <i class="fab fa-linux"></i>
                    <div>
                        <div>Linux</div>
                        <small>.AppImage - 52 MB</small>
                    </div>
                </a>
            </div>
        </div>
        
        <!-- Fonctionnalit√©s -->
        <div class="features">
            <div class="feature">
                <i class="fas fa-wifi-slash fa-3x" style="color: #00d4ff; margin-bottom: 15px;"></i>
                <h3>Mode hors ligne</h3>
                <p>Jouez sans connexion internet</p>
            </div>
            
            <div class="feature">
                <i class="fas fa-bell fa-3x" style="color: #00d4ff; margin-bottom: 15px;"></i>
                <h3>Notifications</h3>
                <p>Alertes pour les nouveaux d√©fis</p>
            </div>
            
            <div class="feature">
                <i class="fas fa-bolt fa-3x" style="color: #00d4ff; margin-bottom: 15px;"></i>
                <h3>Performance</h3>
                <p>Optimis√© pour mobile et desktop</p>
            </div>
            
            <div class="feature">
                <i class="fas fa-sync-alt fa-3x" style="color: #00d4ff; margin-bottom: 15px;"></i>
                <h3>Mises √† jour</h3>
                <p>Automatiques et silencieuses</p>
            </div>
        </div>
        
        <!-- Instructions -->
        <div class="panel">
            <h2><i class="fas fa-info-circle"></i> Comment installer</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                <div>
                    <h3><i class="fas fa-mobile-alt"></i> Sur mobile</h3>
                    <ol style="text-align: left; padding-left: 20px;">
                        <li>Ouvrez dans Chrome/Safari</li>
                        <li>Cliquez sur "Partager"</li>
                        <li>S√©lectionnez "Ajouter √† l'√©cran d'accueil"</li>
                        <li>Lancez comme une application</li>
                    </ol>
                </div>
                
                <div>
                    <h3><i class="fas fa-desktop"></i> Sur ordinateur</h3>
                    <ol style="text-align: left; padding-left: 20px;">
                        <li>Cliquez sur le bouton d'installation</li>
                        <li>Autorisez l'installation</li>
                        <li>Lancez depuis le menu D√©marrer</li>
                        <li>Profitez de DAGA !</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="game.js"></script>
    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(registration => {
                    console.log('Service Worker enregistr√© avec succ√®s:', registration);
                })
                .catch(error => {
                    console.log('√âchec d\'enregistrement du Service Worker:', error);
                });
        }
        
        // PWA Installation
        let deferredPrompt;
        const installButton = document.getElementById('installButton');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installButton.style.display = 'flex';
            
            installButton.addEventListener('click', async () => {
                installButton.style.display = 'none';
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`R√©sultat de l'installation: ${outcome}`);
                deferredPrompt = null;
            });
        });
        
        // V√©rifier si l'app est d√©j√† install√©e
        window.addEventListener('appinstalled', () => {
            console.log('DAGA install√© avec succ√®s!');
            installButton.style.display = 'none';
            alert('üéâ DAGA a √©t√© install√© avec succ√®s! Lancez-le depuis votre √©cran d\'accueil.');
        });
        
        // D√©tection de plateforme
        function detectPlatform() {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            
            if (/windows phone/i.test(userAgent)) return "Windows Phone";
            if (/android/i.test(userAgent)) return "Android";
            if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) return "iOS";
            if (/win/i.test(userAgent)) return "Windows";
            if (/mac/i.test(userAgent)) return "macOS";
            if (/linux/i.test(userAgent)) return "Linux";
            
            return "Unknown";
        }
        
        // Afficher les boutons appropri√©s
        document.addEventListener('DOMContentLoaded', () => {
            const platform = detectPlatform();
            console.log(`Plateforme d√©tect√©e: ${platform}`);
            
            // Cache les boutons non pertinents
            if (platform === "Android" || platform === "iOS") {
                document.querySelectorAll('.platform-btn').forEach(btn => {
                    if (!btn.href.includes('android') && !btn.href.includes('ios')) {
                        btn.style.display = 'none';
                    }
                });
            }
        });
    </script>
</body>
</html>
{
  "name": "DAGA Quiz SQL",
  "short_name": "DAGA",
  "description": "Jeu multijoueur SQL avec classement en temps r√©el",
  "start_url": "/index.html",
  "display": "standalone",
  "display_override": ["window-controls-overlay", "standalone"],
  "orientation": "portrait",
  "background_color": "#1a2a6c",
  "theme_color": "#3498db",
  "categories": ["education", "games", "productivity"],
  "icons": [
    {
      "src": "icons/icon-72.png",
      "sizes": "72x72",
      "type": "image/png"
    },
    {
      "src": "icons/icon-96.png",
      "sizes": "96x96",
      "type": "image/png"
    },
    {
      "src": "icons/icon-128.png",
      "sizes": "128x128",
      "type": "image/png"
    },
    {
      "src": "icons/icon-144.png",
      "sizes": "144x144",
      "type": "image/png"
    },
    {
      "src": "icons/icon-152.png",
      "sizes": "152x152",
      "type": "image/png"
    },
    {
      "src": "icons/icon-192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "icons/icon-384.png",
      "sizes": "384x384",
      "type": "image/png"
    },
    {
      "src": "icons/icon-512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ],
  "screenshots": [
    {
      "src": "screenshots/screenshot1.png",
      "sizes": "1280x720",
      "type": "image/png",
      "form_factor": "wide"
    },
    {
      "src": "screenshots/screenshot2.png",
      "sizes": "750x1334",
      "type": "image/png",
      "form_factor": "narrow"
    }
  ],
  "shortcuts": [
    {
      "name": "Nouvelle partie",
      "short_name": "Jouer",
      "description": "D√©marrer une nouvelle partie",
      "url": "/game.html?action=new",
      "icons": [{ "src": "icons/play-icon.png", "sizes": "96x96" }]
    },
    {
      "name": "Classement",
      "short_name": "Scores",
      "description": "Voir le classement global",
      "url": "/game.html?action=leaderboard",
      "icons": [{ "src": "icons/leaderboard-icon.png", "sizes": "96x96" }]
    }
  ],
  "related_applications": [],
  "prefer_related_applications": false,
  "scope": "/",
  "dir": "ltr",
  "lang": "fr",
  "protocol_handlers": [
    {
      "protocol": "web+daga",
      "url": "/game.html?invite=%s"
    }
  ]
}
// Service Worker pour DAGA Quiz
const CACHE_NAME = 'daga-cache-v1.0.0';
const urlsToCache = [
  '/',
  '/index.html',
  '/game.html',
  '/style.css',
  '/game.js',
  '/manifest.json',
  'icons/icon-192.png',
  'icons/icon-512.png',
  'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css'
];

// Installation
self.addEventListener('install', event => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache => {
        console.log('Cache ouvert');
        return cache.addAll(urlsToCache);
      })
      .then(() => self.skipWaiting())
  );
});

// Activation
self.addEventListener('activate', event => {
  event.waitUntil(
    caches.keys().then(cacheNames => {
      return Promise.all(
        cacheNames.map(cacheName => {
          if (cacheName !== CACHE_NAME) {
            console.log('Suppression de l\'ancien cache:', cacheName);
            return caches.delete(cacheName);
          }
        })
      );
    }).then(() => self.clients.claim())
  );
});

// Fetch
self.addEventListener('fetch', event => {
  event.respondWith(
    caches.match(event.request)
      .then(response => {
        if (response) {
          return response;
        }
        
        return fetch(event.request).then(response => {
          if (!response || response.status !== 200 || response.type !== 'basic') {
            return response;
          }
          
          const responseToCache = response.clone();
          
          caches.open(CACHE_NAME)
            .then(cache => {
              cache.put(event.request, responseToCache);
            });
            
          return response;
        });
      }).catch(() => {
        // Fallback pour les pages HTML
        if (event.request.headers.get('accept').includes('text/html')) {
          return caches.match('/index.html');
        }
        
        // Fallback pour les images
        if (event.request.headers.get('accept').includes('image')) {
          return caches.match('icons/icon-512.png');
        }
      })
  );
});

// Background Sync
self.addEventListener('sync', event => {
  if (event.tag === 'sync-scores') {
    event.waitUntil(syncScores());
  }
});

async function syncScores() {
  try {
    const scores = await getScoresFromIndexedDB();
    await sendScoresToServer(scores);
    await clearScoresFromIndexedDB();
  } catch (error) {
    console.error('Erreur de synchronisation:', error);
  }
}

// Push Notifications
self.addEventListener('push', event => {
  const data = event.data ? event.data.json() : {};
  
  const options = {
    body: data.body || 'Nouveau d√©fi disponible !',
    icon: 'icons/icon-192.png',
    badge: 'icons/badge-72.png',
    vibrate: [100, 50, 100],
    data: {
      url: data.url || '/game.html'
    },
    actions: [
      {
        action: 'play',
        title: 'Jouer',
        icon: 'icons/play-icon.png'
      },
      {
        action: 'dismiss',
        title: 'Fermer',
        icon: 'icons/close-icon.png'
      }
    ]
  };
  
  event.waitUntil(
    self.registration.showNotification(data.title || 'DAGA Quiz', options)
  );
});

self.addEventListener('notificationclick', event => {
  event.notification.close();
  
  if (event.action === 'play') {
    event.waitUntil(
      clients.openWindow(event.notification.data.url)
    );
  }
});
{
  "name": "daga-quiz-sql",
  "version": "1.0.0",
  "description": "Application de quiz SQL multijoueur",
  "main": "main.js",
  "scripts": {
    "start": "electron .",
    "build": "electron-builder",
    "build:windows": "electron-builder --windows",
    "build:mac": "electron-builder --mac",
    "build:linux": "electron-builder --linux",
    "pack": "electron-builder --dir"
  },
  "author": "Bienvenu DAGA",
  "license": "MIT",
  "devDependencies": {
    "electron": "^25.0.0",
    "electron-builder": "^24.0.0"
  },
  "build": {
    "appId": "com.daga.quizsql",
    "productName": "DAGA Quiz SQL",
    "directories": {
      "output": "dist"
    },
    "files": [
      "**/*",
      "!node_modules/**/*"
    ],
    "win": {
      "target": "nsis",
      "icon": "icons/icon.ico"
    },
    "mac": {
      "target": "dmg",
      "icon": "icons/icon.icns"
    },
    "linux": {
      "target": "AppImage",
      "icon": "icons/icon.png"
    },
    "nsis": {
      "oneClick": false,
      "allowToChangeInstallationDirectory": true,
      "createDesktopShortcut": true,
      "createStartMenuShortcut": true
    }
  }
} 
const { app, BrowserWindow, Menu, Tray, nativeImage } = require('electron');
const path = require('path');

let mainWindow;
let tray = null;

function createWindow() {
  mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    minWidth: 800,
    minHeight: 600,
    icon: path.join(__dirname, 'icons/icon.png'),
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
      enableRemoteModule: false,
      preload: path.join(__dirname, 'preload.js')
    },
    frame: true,
    titleBarStyle: 'hiddenInset',
    backgroundColor: '#1a2a6c'
  });

  // Charger le jeu
  mainWindow.loadFile('index.html');
  
  // Ouvrir les DevTools en d√©veloppement
  if (process.env.NODE_ENV === 'development') {
    mainWindow.webContents.openDevTools();
  }
  
  // Gestion de la fermeture
  mainWindow.on('closed', () => {
    mainWindow = null;
  });
  
  // Cr√©er le menu
  createMenu();
  
  // Cr√©er la tray icon
  createTray();
}

function createMenu() {
  const template = [
    {
      label: 'DAGA',
      submenu: [
        {
          label: 'Nouvelle partie',
          accelerator: 'CmdOrCtrl+N',
          click: () => {
            mainWindow.loadFile('game.html');
          }
        },
        { type: 'separator' },
        {
          label: 'Classement',
          click: () => {
            mainWindow.webContents.send('show-leaderboard');
          }
        },
        { type: 'separator' },
        {
          label: 'Quitter',
          accelerator: 'CmdOrCtrl+Q',
          click: () => {
            app.quit();
          }
        }
      ]
    },
    {
      label: '√âdition',
      submenu: [
        { role: 'undo' },
        { role: 'redo' },
        { type: 'separator' },
        { role: 'cut' },
        { role: 'copy' },
        { role: 'paste' }
      ]
    },
    {
      label: 'Affichage',
      submenu: [
        { role: 'reload' },
        { role: 'forcereload' },
        { role: 'toggledevtools' },
        { type: 'separator' },
        { role: 'resetzoom' },
        { role: 'zoomin' },
        { role: 'zoomout' },
        { type: 'separator' },
        { role: 'togglefullscreen' }
      ]
    },
    {
      label: 'Aide',
      submenu: [
        {
          label: 'Documentation',
          click: async () => {
            const { shell } = require('electron');
            await shell.openExternal('https://github.com/daga-quiz/docs');
          }
        },
        {
          label: 'Signaler un bug',
          click: async () => {
            const { shell } = require('electron');
            await shell.openExternal('https://github.com/daga-quiz/issues');
          }
        }
      ]
    }
  ];
  
  const menu = Menu.buildFromTemplate(template);
  Menu.setApplicationMenu(menu);
}

function createTray() {
  const iconPath = path.join(__dirname, 'icons/tray-icon.png');
  const trayIcon = nativeImage.createFromPath(iconPath);
  
  tray = new Tray(trayIcon.resize({ width: 16, height: 16 }));
  
  const contextMenu = Menu.buildFromTemplate([
    {
      label: 'Ouvrir DAGA',
      click: () => {
        if (mainWindow === null) {
          createWindow();
        } else {
          mainWindow.show();
        }
      }
    },
    {
      label: 'Nouvelle partie',
      click: () => {
        mainWindow.loadFile('game.html');
        mainWindow.show();
      }
    },
    { type: 'separator' },
    {
      label: 'Quitter',
      click: () => {
        app.quit();
      }
    }
  ]);
  
  tray.setToolTip('DAGA Quiz SQL');
  tray.setContextMenu(contextMenu);
  
  tray.on('click', () => {
    if (mainWindow === null) {
      createWindow();
    } else {
      mainWindow.isVisible() ? mainWindow.hide() : mainWindow.show();
    }
  });
}

// √âv√©nements de l'application
app.whenReady().then(createWindow);

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit();
  }
});

app.on('activate', () => {
  if (mainWindow === null) {
    createWindow();
  }
});

// Emp√™cher les instances multiples
const gotTheLock = app.requestSingleInstanceLock();

if (!gotTheLock) {
  app.quit();
} else {
  app.on('second-instance', () => {
    if (mainWindow) {
      if (mainWindow.isMinimized()) mainWindow.restore();
      mainWindow.focus();
    }
  });
} 
# Installation des d√©pendances
npm install

# Build pour Windows
npm run build:windows

# Build pour Mac
npm run build:mac

# Build pour Linux
npm run build:linux

# Build pour toutes les plateformes
npm run build
